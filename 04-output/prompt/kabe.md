kabe# タスク壁打ちプロンプト

添付したタスクについて壁打ちをしてください。
それぞれ1個ずつタスクになっています。

## 目的

曖昧なタスク記述を、Claude Codeが即座に実装できるレベルまで明確化し、ドキュメント化する。

---

## Phase 0: 事前調査（壁打ち開始前に必ず実行）

壁打ちを始める前に、以下の手順でプロジェクトとタスク関連ファイルを把握する。

### Step 1: プロジェクト構造の把握

- `src/` 以下のディレクトリツリーを確認する
- 既存のユーティリティ、共通モジュール、型定義の配置を把握する

### Step 2: タスク関連ファイルの読み込み

タスク内容から関連しそうなファイルを推測し、事前に読み込む：

- タスクで言及されている機能に関連するコンポーネント
- 関連するhooks、utils、型定義
- 依存関係にあるファイル（import元/先）

### Step 3: 読み込み結果の報告

壁打ち開始前に、以下を報告する：

```
## 📁 事前調査結果

### プロジェクト構造
[ディレクトリツリーの要約]

### 読み込んだファイル一覧
| ファイル | 読み込み理由 |
|---------|-------------|
| `path/to/file.ts` | [なぜこのファイルを読んだか] |

### 把握した既存実装
- [関連する既存の実装・パターンのサマリー]

---
それでは壁打ちを開始します。
```

---

## 壁打ちのルール

- **進め方**: タスクを1つずつ順番に壁打ちする（全タスク並行ではなく直列で処理）
- **質問形式**: 関連する質問を2〜3個まとめて聞く
- **質問の形**: 選択肢形式やYes/Noなど、簡単に答えられる形にする
- **質問時の提案ルール**:
  - 各質問には必ず **おすすめの選択肢** を明示すること
  - あわせて **「なぜその選択肢がおすすめか」** を、以下の観点で簡潔に説明すること
    - 実装のシンプルさ
    - 将来の変更耐性
    - Claude Code が自走実装しやすいか
  - 例:
    - おすすめ: A  
      理由: 状態管理が単純になり、影響範囲が限定されるため
- **往復回数**: 要件が完全に明確になるまで何往復でもOK
- **不明点の扱い**: 全ての曖昧さを解消するまで次のタスクに進まない

---

## 完了時の処理

1タスクの要件が明確になったら：

1. `/Users/anno/Downloads/weight/docs/todo-task/` に詳細なドキュメントファイルを出力する
   - ファイル名: `task-XXX-[タスク名].md`（XXXは連番）
2. 「次のタスクに進みますか？」と確認する

---

## ドキュメント出力フォーマット

要件が明確になったら、以下の形式でMarkdownファイルを作成する：

```markdown
# タスクXXX：[タスク名]

**ステータス:** 未着手
**優先度:** [高/中/低]
**ブランチ:** TBD
**壁打ち日:** YYYY-MM-DD

---

## 概要

[タスクの概要を1〜2文で]

---

## 背景

### 現状の問題

- 具体的な問題の説明

### 設計方針（壁打ちで確定）

| 方針 | 説明 |
|------|------|
| **方針名** | 説明 |

---

## 事前調査で把握した既存実装

| ファイル | 内容 | 本タスクとの関連 |
|---------|------|-----------------|
| `path/to/file.ts` | ファイルの概要 | どう関連するか |

---

## 変更一覧

### 1. [変更対象1]

**変更内容**: [何をどう変えるか]

\`\`\`typescript
// Before
[変更前のコード]

// After
[変更後のコード]
\`\`\`

**理由**: [なぜこの変更が必要か]

---

## 新規ユーティリティ関数（必要な場合）

### 1. [関数名]（`[ファイルパス]`）

\`\`\`typescript
[実装コード]
\`\`\`

---

## 実装手順

### Phase 1: [フェーズ名]

- [ ] 具体的なタスク1
- [ ] 具体的なタスク2

### Phase 2: [フェーズ名]

- [ ] 具体的なタスク3

---

## 関連ファイル

### 変更対象

| ファイル | 変更内容 |
|---------|----------|
| `path/to/file.ts` | 変更内容 |

### 新規作成

| ファイル | 説明 |
|---------|------|
| `path/to/new-file.ts` | 説明 |

### 参照のみ（変更なし）

| ファイル | 参照理由 |
|---------|----------|
| `path/to/file.ts` | なぜ参照したか |

---

## 確認事項

- [ ] TypeScriptエラー: 0件
- [ ] 動作確認: [確認項目]

---

## 注意事項

- 実装時の注意事項があれば記載

---

## 壁打ち決定事項サマリー

### 質問と回答一覧

| # | 質問 | 決定 |
|---|------|------|
| 1 | 質問内容 | 回答（A/B/Cなど） |

### 保留事項

| 項目 | 理由 |
|------|------|
| 保留した項目 | 保留理由 |
```

---

## 実装方針

- **破壊的変更OK**: 未リリースのアプリのため、DBスキーマ変更・API変更・データ構造の変更など、破壊的な変更も積極的に採用してOK
- 「後方互換性のために複雑になる」より「シンプルで正しい設計」を優先する

---

## 注意事項

- 実装は行わず、ドキュメント作成のみ
- ファイルパス・関数名レベルまで具体的に指定すること
- 1タスク = 1ドキュメント（複数タスクを受け取っても、1つずつ順番に壁打ち→ドキュメント化）
- 新規ユーティリティ関数が必要な場合は、実装コードも含めて記載

---

それでは壁打ちを始めてください