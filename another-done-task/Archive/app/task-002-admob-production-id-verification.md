# タスク002：AdMob本番IDでの動作確認（アドインスペクター検証）

**ステータス:** 未着手
**優先度:** 高
**ブランチ:** feature/admob-interstitial-ab-test
**壁打ち日:** 2025-01-06
**前提タスク:** タスク001完了後

---

## 概要

本番用App ID・ユニットIDを設定し、実際の本番広告が正しく配信されるか確認する。開発者メニューは引き続き表示し、アドインスペクターで広告設定を検証する。

---

## 背景

### 現状の問題

- タスク001でテストIDでの動作確認は完了
- 本番IDでの広告配信が正常に行われるか未確認
- AdMobコンソールとアプリ側の設定が一致しているか検証が必要

### 設計方針（壁打ちで確定）

| 方針 | 説明 |
|------|------|
| **全て本番IDを使用** | App ID・ユニットIDともに本番用を設定 |
| **開発者メニューは引き続き表示** | アドインスペクターで広告設定を検証するため |
| **内部テスト配布推奨** | TestFlight/Firebase App Distributionでの配布を推奨（誤クリック防止） |

---

## 事前調査で把握した既存実装

| ファイル | 内容 | 本タスクとの関連 |
|---------|------|-----------------|
| `.env.production` | 本番環境設定 | AdMob IDを本番用に変更 |
| `app/views/settings/DeveloperSettingsMenus.js` | 開発者設定メニュー | アドインスペクター起動で検証 |

---

## 変更一覧

### 1. `.env.production` - AdMob IDを本番用に変更

**変更内容**: App IDとユニットIDを本番用に設定

```bash
# Before（タスク001の状態：テストID）
ADMOB_ANDROID_APP_ID=ca-app-pub-3940256099942544~3347511713
ADMOB_IOS_APP_ID=ca-app-pub-3940256099942544~1458002511
ADMOB_INTERSTITIAL_IOS_UNIT_ID=ca-app-pub-3940256099942544/4411468910
ADMOB_INTERSTITIAL_ANDROID_UNIT_ID=ca-app-pub-3940256099942544/1033173712

# After（本番ID）
ADMOB_ANDROID_APP_ID=ca-app-pub-6284018108500346~9806195962
ADMOB_IOS_APP_ID=ca-app-pub-6284018108500346~1002594947
ADMOB_INTERSTITIAL_IOS_UNIT_ID=ca-app-pub-6284018108500346/6373888576
ADMOB_INTERSTITIAL_ANDROID_UNIT_ID=ca-app-pub-6284018108500346/1155444810
```

**理由**: 本番広告が正常に配信されるか確認するため。

---

### 2. 開発者メニューは表示したまま

**変更内容**: タスク001で行った開発者メニュー表示の変更はそのまま維持

**理由**: アドインスペクターで広告設定を検証するため。

---

## 実装手順

### Phase 1: 環境設定の変更

- [ ] `.env.production`のAdMob App IDを本番用に変更
  - iOS: `ca-app-pub-6284018108500346~1002594947`
  - Android: `ca-app-pub-6284018108500346~9806195962`
- [ ] インタースティシャルユニットIDを本番用に変更
  - iOS: `ca-app-pub-6284018108500346/6373888576`
  - Android: `ca-app-pub-6284018108500346/1155444810`

### Phase 2: ビルドと配布

- [ ] iOSの本番ビルド作成
- [ ] Androidの本番ビルド作成
- [ ] （推奨）TestFlight/Firebase App Distributionで内部配布

### Phase 3: 動作確認項目

- [ ] アプリ起動時にクラッシュしないこと
- [ ] 設定画面 > 開発者向け > AdMob設定情報が表示されること
- [ ] 表示されるApp IDが本番用（`ca-app-pub-6284018108500346~...`）であること
- [ ] 表示されるユニットIDが本番用であること
- [ ] エリア詳細画面に3回または5回遷移後、インタースティシャル広告が表示されること
- [ ] AdMobアドインスペクターが起動できること

### Phase 4: アドインスペクターでの検証

- [ ] 設定画面 > 開発者向け > 「AdMobアドインスペクター」をタップ
- [ ] 広告ユニットの設定が正しいことを確認
- [ ] 広告リクエストが成功していることを確認
- [ ] エラーがあれば内容を確認し対処

---

## 関連ファイル

### 変更対象

| ファイル | 変更内容 |
|---------|----------|
| `.env.production` | AdMob App ID・ユニットIDを本番用に変更 |

### 参照のみ（変更なし）

| ファイル | 参照理由 |
|---------|----------|
| `app/views/settings/DeveloperSettingsMenus.js` | アドインスペクター起動方法確認 |

---

## 確認事項

- [ ] TypeScriptエラー: 0件
- [ ] 動作確認: 本番広告が正常に表示される
- [ ] 動作確認: アドインスペクターでエラーがない
- [ ] 動作確認: 設定画面で本番IDが確認できる

---

## 注意事項

- **本番広告が表示されるため、誤クリックに注意**
- 自己クリックはAdMobポリシー違反となる可能性があるため、広告は見るだけにする
- 内部テスト用の配布（TestFlight等）で確認することを推奨
- 確認完了後、タスク003で開発者メニューを非表示に戻す

---

## 壁打ち決定事項サマリー

### 質問と回答一覧

| # | 質問 | 決定 |
|---|------|------|
| 5 | 本番用インタースティシャルユニットID | iOS: `ca-app-pub-6284018108500346/6373888576`, Android: `ca-app-pub-6284018108500346/1155444810` |
| 6 | 3タスク構成の確認 | OK |

### 保留事項

なし

---

## 参考: 本番用AdMob ID一覧

| 項目 | iOS | Android |
|------|-----|---------|
| App ID | `ca-app-pub-6284018108500346~1002594947` | `ca-app-pub-6284018108500346~9806195962` |
| インタースティシャル | `ca-app-pub-6284018108500346/6373888576` | `ca-app-pub-6284018108500346/1155444810` |
